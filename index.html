<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Modern AI Chat - Gemini</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Icon -->
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/4712/4712100.png">
</head>

<body class="bg-slate-900 text-slate-100 min-h-screen flex items-center justify-center">
    <div class="w-full max-w-5xl mx-auto p-4">
        <!-- Card Utama -->
        <div
            class="bg-slate-950/80 border border-slate-800 rounded-3xl shadow-2xl shadow-slate-900/60 backdrop-blur-xl overflow-hidden flex flex-col h-[90vh]">
            
            <!-- Header -->
            <div class="border-b border-slate-800 px-6 py-4 flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-9 h-9 rounded-2xl bg-gradient-to-tr from-indigo-500 via-sky-500 to-emerald-400 flex items-center justify-center text-xl font-bold">
                        AI
                    </div>
                    <div>
                        <h1 class="text-lg font-semibold tracking-tight">Modern AI Chat</h1>
                        <p class="text-xs text-slate-400">Powered by Google Gemini</p>
                    </div>
                </div>

                <div class="flex items-center gap-2 text-xs text-slate-400">
                    <span id="status-dot" class="w-2 h-2 rounded-full bg-emerald-400 animate-pulse"></span>
                    <span id="status-text">Ready</span>
                </div>
            </div>

            <!-- Body -->
            <div class="flex flex-1 min-h-0">
                <!-- Sidebar kecil (optional info) -->
                <aside class="hidden md:flex w-56 border-r border-slate-800 flex-col justify-between bg-slate-950/60">
                    <div class="p-4 space-y-3 text-xs text-slate-300">
                        <p class="text-slate-400 text-[11px] uppercase tracking-[0.12em] mb-2">Quick Tips</p>
                        <ul class="space-y-2 list-disc list-inside">
                            <li>Tanya apa saja tentang coding, HR, retail, dll.</li>
                            <li>Gunakan bahasa Indonesia atau Inggris.</li>
                            <li>Chat ini hanya demo: jangan masukkan data sensitif.</li>
                        </ul>
                    </div>
                    <div class="p-4 border-t border-slate-800 text-[11px] text-slate-500">
                        Built with
                        <span class="font-semibold text-slate-300">HTML</span>,
                        <span class="font-semibold text-slate-300">Tailwind</span>,
                        <span class="font-semibold text-slate-300">JS</span>.
                    </div>
                </aside>

                <!-- Area Chat -->
                <main class="flex-1 flex flex-col">
                    <!-- Messages -->
                    <div id="chat-container"
                         class="flex-1 overflow-y-auto px-4 py-4 space-y-4 scroll-smooth">
                        <!-- Pesan awal bot -->
                        <div class="flex items-start gap-3">
                            <div class="w-8 h-8 rounded-2xl bg-gradient-to-tr from-indigo-500 via-sky-500 to-emerald-400 flex items-center justify-center text-xs font-bold mt-1">
                                AI
                            </div>
                            <div class="bg-slate-800/70 border border-slate-700 rounded-2xl px-4 py-3 max-w-xl shadow-md text-sm">
                                <p class="font-semibold mb-1 text-slate-100">Halo! üëã</p>
                                <p class="text-slate-200">
                                    Saya adalah asisten AI berbasis Google Gemini. Tulis pertanyaanmu di bawah, kita mulai ngobrol.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Input -->
                    <div class="border-t border-slate-800 bg-slate-950/70 px-4 py-3">
                        <form id="chat-form" class="flex gap-2 items-end">
                            <div class="flex-1">
                                <div
                                    class="group flex items-end gap-2 bg-slate-900/70 border border-slate-700 rounded-2xl px-3 py-2 focus-within:border-sky-500 focus-within:ring-1 focus-within:ring-sky-500 transition">
                                    <textarea id="user-input"
                                        class="flex-1 bg-transparent outline-none resize-none text-sm max-h-32 leading-relaxed placeholder:text-slate-500"
                                        rows="1"
                                        placeholder="Tanya apa aja‚Ä¶ (Shift+Enter untuk baris baru)"></textarea>
                                    <button type="submit" id="send-btn"
                                        class="shrink-0 inline-flex items-center justify-center rounded-xl px-3 py-2 text-xs font-semibold bg-sky-500 hover:bg-sky-400 disabled:opacity-40 disabled:cursor-not-allowed transition">
                                        <span>Kirim</span>
                                    </button>
                                </div>
                                <div class="flex justify-between mt-1 text-[10px] text-slate-500">
                                    <span>Tekan Enter untuk kirim</span>
                                    <span>Gemini API demo ‚Ä¢ Jangan gunakan API key di client untuk produksi</span>
                                </div>
                            </div>
                        </form>
                    </div>
                </main>
            </div>
        </div>
    </div>

    <script>
        // ========= KONFIGURASI GEMINI =========
        // ‚ö†Ô∏è GANTI API_KEY DENGAN punyamu, tapi JANGAN commit ke repo publik
        const API_KEY = "AIzaSyBlyZScLwO6NnvfqiInNf2saHFajvI4-N8"; // <- jangan isi key asli di contoh publik
        const GEMINI_MODEL = "gemini-1.5-flash";

        const chatContainer = document.getElementById("chat-container");
        const form = document.getElementById("chat-form");
        const userInput = document.getElementById("user-input");
        const sendBtn = document.getElementById("send-btn");
        const statusDot = document.getElementById("status-dot");
        const statusText = document.getElementById("status-text");

        // Auto resize textarea
        userInput.addEventListener("input", () => {
            userInput.style.height = "auto";
            userInput.style.height = userInput.scrollHeight + "px";
        });

        // Enter = submit, Shift+Enter = newline
        userInput.addEventListener("keydown", (e) => {
            if (e.key === "Enter" && !e.shiftKey) {
                e.preventDefault();
                form.requestSubmit();
            }
        });

        // Tambah pesan ke UI
        function appendMessage(role, content, isLoading = false) {
            const wrapper = document.createElement("div");
            wrapper.className = "flex items-start gap-3";

            const avatar = document.createElement("div");
            avatar.className =
                "w-8 h-8 rounded-2xl flex items-center justify-center text-xs font-bold mt-1";

            if (role === "user") {
                avatar.textContent = "You";
                avatar.classList.add("bg-sky-500/90");
            } else {
                avatar.textContent = "AI";
                avatar.classList.add("bg-gradient-to-tr", "from-indigo-500", "via-sky-500", "to-emerald-400");
            }

            const bubble = document.createElement("div");
            bubble.className =
                "bg-slate-800/80 border border-slate-700 rounded-2xl px-4 py-3 max-w-xl shadow-md text-sm whitespace-pre-wrap text-slate-100";

            if (isLoading) {
                bubble.innerHTML = `
                    <div class="flex items-center gap-2 text-slate-300">
                        <span class="w-2 h-2 rounded-full bg-slate-400 animate-bounce"></span>
                        <span class="w-2 h-2 rounded-full bg-slate-400 animate-bounce [animation-delay:0.15s]"></span>
                        <span class="w-2 h-2 rounded-full bg-slate-400 animate-bounce [animation-delay:0.3s]"></span>
                    </div>
                `;
            } else {
                bubble.textContent = content;
            }

            wrapper.appendChild(avatar);
            wrapper.appendChild(bubble);
            chatContainer.appendChild(wrapper);
            chatContainer.scrollTop = chatContainer.scrollHeight;

            return bubble;
        }

        // Call Gemini API (REST)
        async function callGemini(prompt) {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/${GEMINI_MODEL}:generateContent?key=${API_KEY}`;

            const body = {
                contents: [
                    {
                        role: "user",
                        parts: [{ text: prompt }],
                    },
                ],
            };

            const res = await fetch(url, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(body),
            });

            if (!res.ok) {
                const errText = await res.text();
                throw new Error("API error: " + res.status + " - " + errText);
            }

            const data = await res.json();
            const text =
                data?.candidates?.[0]?.content?.parts?.[0]?.text ??
                "(Tidak ada respons dari model.)";
            return text;
        }

        // Handle submit
        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            const text = userInput.value.trim();
            if (!text) return;

            // tampilkan pesan user
            appendMessage("user", text);
            userInput.value = "";
            userInput.style.height = "auto";

            // lock tombol & ubah status
            sendBtn.disabled = true;
            statusDot.classList.remove("bg-emerald-400");
            statusDot.classList.add("bg-amber-400", "animate-pulse");
            statusText.textContent = "Thinking...";

            // bubble loading
            const loadingBubble = appendMessage("assistant", "", true);

            try {
                const reply = await callGemini(text);

                // isi jawaban
                loadingBubble.innerHTML = "";
                loadingBubble.textContent = reply;
            } catch (err) {
                console.error(err);
                loadingBubble.innerHTML = "";
                loadingBubble.textContent =
                    "Terjadi error saat memanggil API Gemini.\n\nDetail: " + err.message;
            } finally {
                // kembalikan status
                sendBtn.disabled = false;
                statusDot.classList.remove("bg-amber-400");
                statusDot.classList.add("bg-emerald-400");
                statusText.textContent = "Ready";
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }
        });
    </script>
</body>

</html>
